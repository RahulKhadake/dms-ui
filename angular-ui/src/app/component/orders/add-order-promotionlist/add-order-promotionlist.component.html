<div class="font">
    <div class="main">
        <div class="containerrr promotionpopup-scroll">
            <div class="addUser" style="margin-top: -14px;">
                <mat-icon mat-button class="close-icon" [mat-dialog-close]="false">close</mat-icon>
            </div>
            <div class="head-t">
                <h3 class="addU font">
                    <!-- {{actineLabel}} : -->
                    <b>Promotions Item Details</b>
                </h3>
                <div class="row top-bottom">
                    <div class="row text-center"></div>
                </div>

                <!-- <div class="promotion-card">
                    <div class="promoimgs">
                        <div class="col-md-4 img-container" *ngFor="let Item of arrayOfImages;let i=index;">
                            <div (click)="getpromotionlistById($event,Item);">
                                <img class="card1" src="data:image/jpeg;base64,{{Item.imageurl}}"
                                    [ngClass]="{ 'selected': Item.isSelected }" alt="image does not exit">
                            </div>
                        </div>

                    </div>
                </div> -->

                <div class="label-div">
                    <!-- <span class="selected-promotion-label">Selected Promotions</span> -->
                    <span class="selected-promotion-label"></span>
                </div>

                <!-- Promotion Details Start -->


                <div class="t_op-bottom mt-4">
                    <div (click)="expandPromotions()" class="coll_apsible">
                        <div class="row">
                            <div class="col-md-11">
                                <p class="ItemsPro  mt-2 ">Promotions Items </p>
                            </div>
                            <div class="col-md-1">
                            
                            </div>
                        </div>


                    </div>
                    <div class="con_tent" *ngIf="!viewpromotions">
                        <div class="maindiv">
                            <div class="row">
                                <div class=" col-md-5">
                                    <div class="promoimages1" *ngFor="let data of griddatapromotions">
                                        <img class="displayed-img" src="data:image/jpeg;base64,{{imageUrl}}"
                                            alt="Displayed Image" />
                                        <span id="proname">{{data.promotionName}}</span>

                                        <!-- 2 Promotion MOQ-->
                                        <span *ngIf="data.promotionTypesId ===2">
                                            <span *ngFor="let setItem of data.promoDetails.buySets;let j=index">
                                                <span *ngIf="j===0">
                                                    <span *ngFor="let promos of setItem.buyGroups">
                                                        <span id="m_oq"> MOQ-{{promos.moq}}</span>
                                                    </span>
                                                </span>
                                            </span>
                                        </span>

                                        <!-- 1 Promotion MOQ -->
                                        <span *ngIf="data.promotionTypesId ===1">
                                            <span *ngFor="let promos of data.promoDetails.buyGroups">
                                                <span id="m_oq"> MOQ-{{promos.moq}}</span>
                                            </span>
                                        </span>

                                        <!-- 3 Promotion  MOQ-->
                                        <span *ngIf="data.promotionTypesId==3">
                                            <span id="m_oq"> MOQ-{{data.promoDetails.moq}}</span>

                                        </span>

                                        <!-- 4 Promotion  MOQ-->
                                        <span *ngIf="data.promotionTypesId==4">
                                            <span id="m_oq"> MOQ-{{data.promoDetails.moq}}</span>
                                        </span>
                                        <mat-icon class="showicon" (click)="showPromotionInfo($event,data)">
                                            remove_red_eye </mat-icon>
                                    </div>
                                    <div *ngFor="let data of griddatapromotions">
                                        <p id="validform">Valid form:{{data.startDate |
                                            date:'dd/MM/yyyy'}}&nbsp;&nbsp;to&nbsp;&nbsp;{{data.endDate|
                                            date:'dd/MM/yyyy'}}</p>
                                    </div>
                                    <div *ngFor="let data of griddatapromotions">
                                        <p id="Remarks">Remarks*{{data.remarks}}</p>
                                    </div>
                                </div>


                                <div class=" col-md-7">

                                    <div class="promoitems-card">

                                        <div class="promoitemsDetails">
                                             <div *ngFor="let data of griddatapromotions"> 
                                                 <div *ngIf="data.promotionTypesId ===1">
                                                    <div *ngFor="let promos of data.promoDetails.buyGroups">
                                                        <div class="row  FirstPromotioncalcul">
                                                            <div class="col" style="background: rgba(222, 226, 230, 0.2);height: 60px;">
                                                                <label id="FirstPromotionlabelCal">Total Order Qty</label>
                                                                <span id="FirstproTotalorderqyt">{{promos.totalQuantity+storedValue}}</span>
                                                            </div>
                                                            <div class="col"  style="background: rgba(222, 226, 230, 0.2);">
                                                                <label id="FirstPromotionlabelCal">Total Order  Amount</label>
                                                                <span id="FirstPromotiontotalselectamount">{{promos.totalAmount+storedTotalAmount}}</span>
                                                            </div>
                                                            <div class="row" style="height: 60px;">
                                                                <div class="col">
                                                                    <label id="FirstPromotionProOrderQTY">Promo Order Qty</label>
                                                                    <span  id="PromoOrderQtyFirstpromotion">{{promos.totalQuantity}}</span>
                                                                </div>
                                                                <div class="col">
                                                                    <label id="FirstPromotionProOrderQTY">Promo Order   Amount</label>
                                                                    <span id="PromotionAmountQtyFirstpromotion">{{promos.totalAmount}}</span>
                                                                </div>
                                                            </div>
                                                            <div class="col"
                                                                style="background: rgba(222, 226, 230, 0.2); height: 60px;"
                                                                *ngFor="let promos of data.promoDetails.getGroups">
                                                                <label id="FirstProFreeOrderQty">Promo<span
                                                                        style="margin-left: 7px;">Free</span>
                                                                    Qty</label>
                                                                <span id="FREEORDERQTYfirstpromotion">{{promos.totalQuantity}}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div> 

                                                <!-- 2 Promotion Start  -->
                                                <div *ngIf="data.promotionTypesId ===2">
                                                    <div *ngFor="let setItem of data.promoDetails.buySets;let j=index">
                                                        <div *ngIf="j === 0">
                                                            <div *ngFor="let promos of setItem.buyGroups">
                                                                <div class="row SecondPromotioncalcution">
                                                                    <div class="col"
                                                                        style="background: rgba(222, 226, 230, 0.2);height: 60px;">
                                                                        <label id="SecondPromotionlabelCal">Total Order
                                                                            Qty</label>
                                                                        <span
                                                                            id="SecondPromotiontotalorderqty">{{promos.totalQuantity}}
                                                                        </span>
                                                                    </div>

                                                                    <div class="col"
                                                                        style="background: rgba(222, 226, 230, 0.2);">
                                                                        <label id="SecondPromotionlabelCal">Total Order
                                                                            Amount</label>
                                                                        <span
                                                                            id="secondPromotionTotalorderamount">{{promos.totalAmount
                                                                            }}</span>
                                                                    </div>

                                                                    <div class="row" style="height: 57px;">
                                                                        <div class="col">
                                                                            <label id="SecondPromotionProOrderQty">Promo
                                                                                Order Qty</label>
                                                                            <span
                                                                                id="SecondPromotionProOrderquanty">{{promos.totalQuantity}}</span>
                                                                        </div>
                                                                        <div class="col">
                                                                            <label id="SecondPromotionProOrderQty">Promo
                                                                                Order Amount</label>
                                                                            <span
                                                                                id="PromoorderAMOUNT">{{promos.totalAmount
                                                                                }} </span>
                                                                        </div>
                                                                    </div>

                                                                    <div class="row"
                                                                        style="background: rgba(222, 226, 230, 0.2); margin-left: 1px;height: 53px;">
                                                                        <!-- <div class="col" >
                                                                        <label id="SecondPromotionFreeorderqty">Promo<span style="margin-left: 7px;">Free</span>  Qty</label>
                                                                        <span id="FreeOrderQTySecondPromotion"> {{promos.totalQuantity}} </span>
                                                                    </div> -->
                                                                    <div *ngFor="let setItem of data.promoDetails.getSets; let j=index" style="margin-left: 1px; height: 53px;">
                                                                        <div *ngIf="j === 0">
                                                                          <div *ngFor="let promos of setItem.getGroups">
                                                                            <div class="row" style="display: inline;">
                                                                              <div class="col" style="margin-top: -20px;">
                                                                                <label id="SecondPromotionFreeorderqty"> Promo <span style="margin-left: 6px;">Free</span> Qty </label>
                                                                                <span id="FREEQTYsecondpromotion">{{ promos.totalQuantity }}</span>
                                                                              </div>
                                                                            </div>
                                                                          </div>
                                                                        </div>
                                                                    </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!--3 Promotion  -->
                                                <div *ngIf="data.promotionTypesId ===3" class="calculation">
                                                    <div class="row mt-4" style="margin-left: 0%;">
                                                        <div class="col"
                                                            style="background: rgba(222, 226, 230, 0.2);height: 60px;">
                                                            <label id="totalorderqty" for="inputField">Total Order
                                                                Qty</label>
                                                            <span id="TotalOrderQTY">
                                                                {{data.promoDetails.totalQuantity+StoreThreePromotionsselectedqty}}</span>


                                                        </div>
                                                        <div class="col" style="background: rgba(222, 226, 230, 0.2);">
                                                            <label id="totalorderamount" for="inputField">Total Order
                                                                Amount</label>
                                                            <span
                                                                id="TotalOrderAmount">{{data.promoDetails.DiscountAmount
                                                                +StoredThreePromoTotalAmount}}</span>

                                                        </div>
                                                        <div class="w-100"></div>
                                                        <div class="col mt-3">
                                                            <label id="Promoorderqty" for="inputField">Promo Order
                                                                Qty</label>
                                                            <span id="ProOrderqty">
                                                                {{data.promoDetails.totalQuantity}}</span>
                                                        </div>
                                                        <div class="col mt-3">
                                                            <label id="Promoorderamount" for="inputField">Promo Order
                                                                Amount</label>
                                                            <span
                                                                id="PromoOrderAmount">{{data.promoDetails.DiscountAmount
                                                                ?? 0 }}</span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- 4 Promotion  -->
                                                <div *ngIf="data.promotionTypesId === 4" class="calculation">
                                                    <div class="row mt-4" style="margin-left: 0%;">
                                                        <div class="col"
                                                            style="background: rgba(222, 226, 230, 0.2);height: 60px;">
                                                            <label id="totalorderqty" for="inputField">Total Order
                                                                Qty</label>
                                                            <span id="TotalOrderQTY">
                                                                {{data.promoDetails.totalQuantity+storedForthProvalue}}</span>
                                                        </div>
                                                        <div class="col" style="background: rgba(222, 226, 230, 0.2);">
                                                            <label id="totalorderamount" for="inputField">Total Order
                                                                Amount</label>
                                                            <span
                                                                id="TotalOrderAmountforthPro">{{data.promoDetails.DiscountAmount
                                                                +StoredForhtPromoTotalAmount}}</span>

                                                        </div>
                                                        <div class="w-100"></div>
                                                        <div class="col mt-3">
                                                            <label id="Promoorderqty" for="inputField">Promo Order
                                                                Qty</label>
                                                            <span id="ProOrderqty">
                                                                {{data.promoDetails.totalQuantity}}</span>
                                                        </div>
                                                        <div class="col mt-3">
                                                            <label id="Promoorderamount" for="inputField">Promo Order
                                                                Amount</label>
                                                            <span
                                                                id="TotalOrderAmountforthPromotion">{{data.promoDetails.DiscountAmount
                                                                ?? 0 }}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div *ngFor="let data of griddatapromotions;let i=index" style="width:110%">
                            <div class="row ">
                                <div class="col-lg-11 buysets">
                                    <div class="content" *ngIf="data.isShowPromos" style="border: none;">
                                        <div *ngFor="let data of griddatapromotions;let i=index" 
                                             style="width:104%;margin-left: -25px;"> 
                                             <div class="content" *ngIf="data.isShowPromos" style="border: none;">
                                                <div *ngIf="data.promotionTypesId==1">
                                                    <div *ngFor="let promos of data.promoDetails.buyGroups ">
                                                        <div class="row">
                                                            <div class="col" style="margin-left: 14px;">
                                                                <span class="buy-grp"> Paid Items</span>
                                                                <span class="total-itemss">
                                                                    <span style="color:#000;"
                                                                        [ngClass]="{ 'txt-error-span': !(promos.isItemValid) && data.showWarningMsg }">
                                                                    </span>
                                                                    <span class="txt-error ms-5"
                                                                        *ngIf="!(promos.isItemValid) && data.showWarningMsg">
                                                                        Please select full required quantity
                                                                    </span>
                                                                </span>
                                                            </div>
                                                            <div class="col-md-0 col-lg-0 col-sm-0">
                                                            </div>
                                                            <div class="col-md-0 col-lg-0 col-sm-0">
                                                            </div>
                                                            <div class="col-md-1 col-lg-1 col-sm-1">
                                                            </div>
                                                            <div class="col-md-0 col-lg-0 col-sm-0" style="margin-top: 10px;" >
                                                                <mat-slide-toggle  (click)="toggleDatapromotionm() ">
                                                                    Items With Order Qty 
                                                                </mat-slide-toggle>                                                                  
                                                            </div> &nbsp;&nbsp;  &nbsp;&nbsp;                                       
                                                           <div class="col-md-2 col-lg-2 col-sm-2" >
                                                            <div class="searchBox11 d-flex">
                                                                <input class="searchInput11" type="text" name="" placeholder="Search..." [(ngModel)]="searchText">
                                                                 <mat-icon  class="searchicons">search</mat-icon> 
                                                                <button class="search-bt_n">Search</button>
                                                            </div>
                                                           </div>
                                                           <div class="col-md-1 col-lg-1 col-sm-1">
                                                                <span id="m_oq"> MOQ <br> &nbsp;{{promos.moq}}</span>
                                                            </div>
                                                            <div class="col-md-1 col-lg-1 col-sm-1">
                                                                <span id="se_lected">Selected<br>&nbsp;&nbsp; {{ totalSelectedQuantity }}</span>
                                                            </div>
                                                            <div class="col-md-1 col-lg-1 col-sm-1">
                                                                <span id="se_lected">{{ promos.moq >= totalSelectedQuantity ? "Remaining" : "Additional" }}<br>&nbsp; &nbsp;{{ promos.moq > totalSelectedQuantity ? (promos.moq - moqselectedreamining(promos)) : (totalSelectedQuantity - promos.moq) }}</span>
                                                            </div>
                                                        </div>
                                                        <div class="tabel-div">
                                                            <table class="tableclass">
                                                              <thead class="table-headercolor">
                                                                <tr>
                                                                  <th data-sortable="true" class="align-center">Product Code</th>
                                                                  <th data-sortable="true" class="align-center">Product Name</th>
                                                                  <th data-sortable="true" class="align-center">Identifiers</th>
                                                                  <th data-sortable="true" class="align-center">Registration No</th>
                                                                  <th data-sortable="true" class="align-center">MOQ</th>
                                                                  <th data-sortable="true" class="align-center">Unit Price</th>
                                                                  <th data-sortable="false" class="align-center">Order Qty</th>
                                                                  <th data-sortable="false" class="align-center">Order Amount</th>
                                                                </tr>
                                                              </thead>
                                                              <tbody class="tbodayheight">
                                                             <tr  *ngFor="let Item of promos.stockitemid | filter:searchText ">
                                                                         <ng-container *ngIf="toggleState ? Item.isProductSelected : true"> 
                                                                      <td style="width: 24px">
                                                                        <input type="checkbox" [checked]="Item.isProductSelected" (change)="checkboxChange($event, Item,data)" />
                                                                      </td>
                                                                      <td style="text-align: left;">{{ Item.productSKUName }}</td>
                                                                      <td style="text-align: left;">{{ Item.stockitemname }}</td>
                                                                      <td style="text-align: left;">{{ Item.materialcustomidentifier }}</td>
                                                                      <td style="text-align: left;">{{ Item.registrationNumber }}</td>
                                                                      <td class="txt-right">{{ promos.moq }}</td>
                                                                      <td class="txt-right">{{ Item.price }}</td>
                                                                      <td>
                                                                        <input type="number" min="0" placeholder="Enter Qty" class="quatity-inp" [(ngModel)]="Item.Quantity" oninput="validity.valid||(value='');"
                                                                          (keyup)="quantityChange(data,Item);" name="Item.Quantity" />
                                                                      </td>
                                                                      <td class="txt-right">{{ (Item.Quantity ?? 0) * Item.price | number : '1.2-2' }}</td>                                                                   
                                                                     </ng-container>                                                          
                                                                    </tr>  
                                                              </tbody>
                                                            </table>                       
                                                          </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <!--  ============================= Set Group -->
                                       
                                        <div *ngFor="let promos of data.promoDetails.getGroups">
                                            <div class="buyGrp 1">

                                                <div class="row">

                                                    <div class="col col-lg-5">

                                                        <span class="buy-grp"> Free Items </span>
                                                        <span class="ml-1" style="color:#000;"
                                                            [ngClass]="{ 'txt-error-span': promos.totalQuantity != (promos.foc) && data.showWarningMsg }"></span>
                                                        <span class="txt-error"
                                                            *ngIf="promos.totalQuantity != (promos.foc) && data.showWarningMsg">
                                                            Please select full required quantity
                                                        </span>

                                                    </div>
                                                 <div class="col col-lg-2">
                                                    <mat-slide-toggle  (click)="toggleDatapromotionmfreeitems() "> Items With Order Qty
                                                    </mat-slide-toggle>

                                                    </div>
                                                    <div class="col col-lg-2">
                                                        <div class="searchBox11 d-flex">
                                                            <input class="searchInput12" type="text" name=""
                                                                placeholder="Search..."
                                                                [(ngModel)]="searchTextFreeItems">
                                                            <mat-icon class="searchiconsFREEITEMS">search</mat-icon>
                                                            <button class="searchBTNFREEITEMS">Search</button>

                                                        </div>
                                                    </div>
                                                    <div class="col col-lg-1">
                                                        <span id="Entitled"> Entitled </span>
                                                    </div>
                                                    <div class="col-lg-1">
                                                        <span id="Freeitemselected">Selected </span>
                                                    </div>
                                                    <div class="col col-lg-1">
                                                        <span id="Remaining">Remaining </span>
                                                    </div>

                                                </div>

                                                <div class="row">
                                                    <div class="col col-lg-9">

                                                    </div>
                                                    <div class="col col-lg-1">
                                                        {{promos.foc }}
                                                    </div>
                                                    <div class=" col-lg-1">
                                                        {{ getTotalSelectedQuantity(promos) }}
                                                    </div>
                                                    <div class="col col-lg-1">
                                                        {{ (promos.foc>getTotalSelectedQuantity(promos))?promos.foc - getTotalSelectedQuantity(promos):0 }}
                                                    </div>

                                                </div>
                                            </div>
                                            <div class="tabel-div1">
                                                <table class="tableclass1">
                                                    <thead class="table-headercolor1">
                                                        <tr>
                                                            <th width="30"></th>
                                                            <th data-sortable="true" class="align-center">Product Code
                                                            </th>
                                                            <th data-sortable="true" class="align-center">Product Name
                                                            </th>
                                                            <th data-sortable="true" class="align-center"> Identifiers
                                                            </th>
                                                            <th data-sortable="true" class="align-center">Registration
                                                                No</th>
                                                            <th data-sortable="true" class="align-center">MOQ</th>
                                                            <th data-sortable="true" class="align-center">Unit Price
                                                            </th>
                                                            <th data-sortable="false" class="align-center">Order Qty
                                                            </th>
                                                            <th data-sortable="false" class="align-center">Order Amount
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="tbodayheight1">
                                                        <tr *ngFor="let Item of promos.stockitemid |filter:searchTextFreeItems">
                                                            <ng-container  *ngIf="toggleStatefreeitems ? Item.isProductSelected : true"> 
                                                            <td style="width:24px"><input type="checkbox"
                                                                    [checked]="Item.isProductSelected"
                                                                    (change)="checkboxChange($event,Item, data)"></td>
                                                            <td style="text-align: left;">{{Item.productSKUName}}</td>
                                                            <td style="text-align: left">{{Item.stockitemname}} </td>
                                                            <td style="text-align: left;">
                                                                {{Item.materialcustomidentifier}}</td>
                                                            <td style="text-align: left;">{{Item.registrationNumber}}
                                                            </td>
                                                            <td class="txt-right">{{promos.moq}}</td>
                                                            <td class="txt-right">{{Item.price}}</td>
                                                            <td><input type="number" placeholder="Enter Qty" min="0"
                                                                    class="quatity-inp" [(ngModel)]="Item.Quantity"
                                                                    (keyup)="quantityChange(data, Item)" oninput="validity.valid||(value='');">
                                                            </td>
                                                            <td class="txt-right">{{((Item.price) * (Item.Quantity))|number : '1.2-2' }}</td>
                                                        </ng-container>
                                                        </tr>

                                                    </tbody>
                                                </table>

                                                <div class="bottom-table1 tt" id="totalnonprobackcolor1">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 2nd promotions -->
                                <div *ngIf="data.promotionTypesId==2">
                                    <div *ngFor="let setItem of data.promoDetails.buySets;let j=index"
                                        style="width:91%;margin-left: 4px;">
                                        <div class="content" *ngFor="let promos of setItem.buyGroups"
                                            style="border: none;">
                                             <div class="buyGrp 1"> 
                                            <div>
                                                <div class="row">
                                                    <div class="col">
                                                        <span class="buy-grp" style="margin-left: 15px;"> Paid Items
                                                        </span>
                                                        <span class="total-itemss">
                                                            <span style="color:#000;"
                                                                [ngClass]="{ 'txt-error-span': !(promos.isItemValid) && data.showWarningMsg }">
                                                            </span>
                                                            <span class="txt-error"
                                                                *ngIf="!(promos.isItemValid) && data.showWarningMsg ">
                                                                Please select full required quantity
                                                            </span>
                                                        </span>

                                                    </div>
                                                     <div class="col-md-0 col-lg-0 col-sm-0">  
                                                        </div>
                                                        <div class="col-md-0 col-lg-0 col-sm-0">    
                                                        </div>
                                                        <div class="col-md-1 col-lg-1 col-sm-1">  
                                                        </div>
                                                        <div class="col-md-2 col-lg-2 col-sm-2" style="margin-top: 10px;" >
                                                            <mat-slide-toggle (click)="SecondPromotiontoggle()"> Items With Order Qty
                                                            </mat-slide-toggle>                                                                  
                                                        </div> &nbsp;

                                                        </div>
                                                    </div>

                                                    <div class="col col-lg-1">
                                                        <span id="m_oq"> MOQ<br>{{promos.moq }}</span>
                                                    </div>
                                                    <div class="col col-lg-1">
                                                        <span id="se_lected">Selected <br>{{promos.totalQuantity }}</span>
                                                    </div>
                                                    <div class="col col-lg-0">
                                                        <span id="se_lected">Remaining <br>
                                                            {{ promos.moq - moqselectedreaminingFORTHPromotion(promos) }}</span>
                                                    </div>
                                                </div>
                                            </div> 
                                                <!-- tabels for 2st promotions -->

                                                <div class="tabel-div_4pro">
                                                    <table class="tableclass4">
                                                        <thead class="table-headercolor4">
                                                            <tr>
                                                                <th data-sortable="true" class="align-center">Product
                                                                    Code</th>
                                                                <th data-sortable="true" class="align-center">Product
                                                                    Name</th>
                                                                <th data-sortable="true" class="align-center">
                                                                    Identifiers</th>
                                                                <th data-sortable="true" class="align-center">
                                                                    Registration No</th>
                                                                <th data-sortable="true" class="align-center">
                                                                    MOQ</th>
                                                                <th data-sortable="true" class="align-center">Unit Price
                                                                </th>
                                                                <th data-sortable="false" class="align-center">Quantity
                                                                </th>
                                                                <th data-sortable="false" class="align-center">Order
                                                                    Amount</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class="tbodayheight4">
                                                            <tr *ngFor="let Item of promos.stockitemid  |filter:searchTextSecondPromotion">
                                                                <ng-container  *ngIf="toggleStatescondpro ? Item.isProductSelected : true"> 
                                                                <td style="width:24px"><input type="checkbox"
                                                                        [checked]="Item.isProductSelected"
                                                                        [disabled]="!promos.isEnable"
                                                                        (change)="checkboxChange($event,Item, data)" />
                                                                </td>
                                                                <td style="text-align: left;">{{Item.productSKUName}}
                                                                </td>
                                                                <td style="text-align: left;">{{Item.stockitemname}}
                                                                </td>
                                                                <td style="text-align: left;">
                                                                    {{Item.materialcustomidentifier}}</td>
                                                                <td style="text-align: left;">
                                                                    {{Item.registrationNumber}}</td>
                                                                <td class="txt-right">{{promos.moq}}</td>
                                                                <td class="txt-right">{{Item.price}}</td>
                                                                <td><input type="number" placeholder="Enter Qty"
                                                                        class="quatity-inp" [(ngModel)]="Item.Quantity"
                                                                        [disabled]="!promos.isEnable"
                                                                        (keyup)="quantityChange(data, Item)"></td>
                                                                <td class="txt-right">{{((Item.Quantity ?? 0) *
                                                                    Item.price)|
                                                                    number : '1.2-2'
                                                                    }}</td>
                                                                    </ng-container>
                                                            </tr>
                                                        </tbody>
                                                    </table>


                                                    <div class="bottom-table4 tt" id="totalnonprobackcolor4">

                                                    </div>



                                                </div>
                                            </div>
                                        </div>



                                        <!-- *ngIf="(j +1) != data.promoDetails.buySets.length" -->
                                        <div class="line-txt" >
                                            <span>(OR)</span>
                                        </div>
                                    </div>

                                  


                                    <!-- <div class="text-error-qty "
                                            *ngIf="data.promoDetails.getGroupsQty || data.promoDetails.buyGroupsQty"
                                            [ngClass]="{ 'txt-error': data.promoDetails.getGroupsQty != data.promoDetails.buyGroupsQty }">
                                            (Total Get Qty {{data.promoDetails.getGroupsQty}}) </div> -->
                                    <!-- </div> -->
                                    
                                    <!-- set groups -->
                                    <div *ngFor="let setItem of data.promoDetails.getSets;let j=index">
                                        <div *ngFor="let promos of setItem.getGroups">
                                            <div class="buyGrp 1">
                                                <!-- headingds for 1st promotions -->
                                                <!-- <div class="row label-div tableborderss"> -->
                                                <!-- <div class="col-md-3">
                                                        <span class="buy-grp"> Set -{{setItem.groupId}}: Get Group
                                                            {{promos.set}}</span>
                                                    </div> -->


                                                <!-- <div class="col-md-6" style="text-align: center;">
                                                        <span class="total-itemss">
                                                            <span class="ml-1" style="color:#000;"
                                                                [ngClass]="{ 'txt-error-span': promos.totalQuantity != (promos.foc) && data.showWarningMsg && promos.isEnable }">(FOC
                                                                {{promos.foc}})</span></span>
                                                               <span class="txt-error"
                                                               *ngIf="!(promos.totalQuantity) && data.showWarningMsg ">
                                                               Please select full required quantity
                                                               </span> 
                                                    </div>  -->


                                                <!-- <div class="col-md-6">
                                                        <button class="searchButton" href="#">
                                                            <i class="material-icons">
                                                                search
                                                            </i>
                                                        </button>
                                                        <div class="searchBox d-flex" style=" cursor: pointer">
                                                            <input class="searchInput" style="font-family: 'Gilroy'"
                                                                type="text" name=""
                                                                placeholder="Type & search for anything"
                                                                (keyup)="onSearchChange($event)">
                                                            <button class="search-btn"
                                          s                      style="font-family: 'Gilroy'">Search</button>

                                                        </div>
                                                    </div> -->

                                                <!-- </div> -->
                                                <div class="row" style="width: 92%;">
                                                    <div class="col col-lg-3">
                                                        <span class="buy-grp" style="margin-left: 2%;"> Free Items
                                                        </span>
                                                        <span class="total-itemss">
                                                            <span class="ml-1" style="color:#000;"
                                                                [ngClass]="{ 'txt-error-span': promos.totalQuantity != (promos.foc) && data.showWarningMsg && promos.isEnable }">
                                                            </span></span>
                                                        <span class="txt-error"
                                                            *ngIf="!(promos.totalQuantity) && data.showWarningMsg ">
                                                            Please select full required quantity
                                                        </span>

                                                    </div>
                                                     <div class="col-md-2 col-lg-2 col-sm-2" style="margin-top: 10px;" >
                                                        <mat-slide-toggle  style="margin-left: 42px;" (click)="SecondPromotionbuygrouptoggle()"> Items With Order Qty
                                                        </mat-slide-toggle>                                                                  
                                                    </div> 
                                                    <div class="col col-lg-3">
                                                         <div class="searchBox11 d-flex">
                                                            <mat-icon  class="searchiconsFREEITEMSsecondpro11">search</mat-icon> 
                                                            <input class="searchInput14" type="text" name="" placeholder="Search..." [(ngModel)]="searchTextSecondPromotionfree">
                                                            <button class="searchBTNFREEITEMSsecondproguy">Search</button>
                                                            
                                                          </div>
                                                    </div>
                                                    <div class="col col-lg-3">
                                                        <div class="searchBox11 d-flex">
                                                            <mat-icon
                                                                class="searchiconsFREEITEMSsecondpro11">search</mat-icon>
                                                            <input class="searchInput14" type="text" name=""
                                                                placeholder="Search..."
                                                                [(ngModel)]="searchTextSecondPromotionfree">
                                                            <button
                                                                class="searchBTNFREEITEMSsecondproguy">Search</button>

                                                        </div>
                                                    </div>

                                                    <div class="col-md-1 col-lg-1 col-sm-1">
                                                        <span id="Entitled"> Entitled<br>
                                                            {{promos.foc}}
                                                        </span>
                                                    </div>

                                                    <div class="col-md-1 col-lg-1 col-sm-1">
                                                        <span id="Freeitemselected">Selected<br>
                                                            {{ getTotalEntitledSelectedRemaining(promos) }} </span>
                                                    </div>
                                                    <div class="col-md-1 col-lg-1 col-sm-1">
                                                        <span id="Remaining">Remaining<br>
                                                            {{ promos.foc - getTotalEntitledSelectedRemaining(promos) }}
                                                        </span>
                                                    </div>
                                                </div>
                                                <!-- tabels for 2st promotions -->
                                                <div class="tabel-di_v2">
                                                    <table class="tabelgetsetItems">

                                                        <thead class="table-headercolorGetset">
                                                            <tr>
                                                                <th data-sortable="true" class="align-center">Product
                                                                    Code</th>
                                                                <th data-sortable="true" class="align-center">Product
                                                                    Name</th>
                                                                <th data-sortable="true" class="align-center">
                                                                    Identifiers</th>
                                                                <th data-sortable="true" class="align-center">
                                                                    Registraion No</th>
                                                                <th data-sortable="true" class="align-center">
                                                                    MOQ</th>

                                                                <th data-sortable="true" class="align-center">Unit Price
                                                                </th>
                                                                <th data-sortable="false" class="align-center"> Order
                                                                    Qty</th>
                                                                <th data-sortable="false" class="align-center">Order
                                                                    Amount</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class="tbodayheightGetset">
                                                            <tr class="table-row"
                                                                *ngFor="let Item of promos.stockitemid |filter:searchTextSecondPromotionfree">
                                                                
                                                                <ng-container  *ngIf="toggleStatescondprofreeitems ? Item.isProductSelected : true"> 
                                                                <td style="width: 30px;"><input type="checkbox"
                                                                        [disabled]="!promos.isEnable"
                                                                        [checked]="Item.isProductSelected"
                                                                        (change)="checkboxChange($event,Item, data)">
                                                                </td>
                                                                <td style="text-align: left;">{{Item.productSKUName}}
                                                                </td>
                                                                <td style="text-align: left;">{{Item.stockitemname}}
                                                                </td>
                                                                <td style="text-align: left;">
                                                                    {{Item.materialcustomidentifier}}</td>
                                                                <td style="text-align: left;">
                                                                    {{Item.registrationNumber}}</td>
                                                                <td class="txt-right">{{promos.moq}}</td>
                                                                <td class="txt-right">{{Item.price}}</td>
                                                                <!-- <td><input type="number" placeholder="Enter"
                                                                        [disabled]="!promos.isEnable" class="quatity-inp"
                                                                        [(ngModel)]="Item.stock"></td> -->
                                                                <!-- <td>
                                                                    <select class="tax-select" placeholder="select"
                                                                        [disabled]="!promos.isEnable"
                                                                        [(ngModel)]="Item.Taxid">
                                                                        <option value="" selected hidden>Select tax</option>
                                                                        <option *ngFor="let option of taxdropdowndata"
                                                                            [value]="option.taxTemplateId">
                                                                            {{option.taxTemplateName}}
                                                                        </option>
                                                                    </select>
    
                                                                    <img src="assets/img/doubleTickes-default.svg"
                                                                        (click)="doubleClick(promos.stockitemid, Item.Taxid)"
                                                                        alt="double-blue-tick">
                                                                </td> -->
                                                                <td><input type="number" placeholder="Enter Qty"
                                                                        class="quatity-inp"
                                                                        [disabled]="!promos.isEnable"
                                                                        [(ngModel)]="Item.Quantity"
                                                                        (keyup)="quantityChange(data, Item)"></td>
                                                                <td class="txt-right">{{((Item.Quantity ?? 0) *
                                                                    Item.price)|
                                                                    number : '1.2-2'
                                                                    }}</td>
                                                                    </ng-container>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <div class="bottom-tableGetset4 tt"
                                                        id="totalnonprobackcolorGetset4">
                                                        <!-- <tr>
                                                            <td colspan="6" class="btm-total"><b>Total </b></td>
                                                            <td class="btm-total txt-right">
                                                             {{promos.totalQuantity ?? 0}}
                                                            </td>
                                                            <td class="btm-total txt-right">
                                                                {{promos.totalAmount ?? 0 | number : '1.2-2'}}
                                                            </td>
                                                        </tr> -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="line-txtt" *ngIf="(j +1) != data.promoDetails.getSets.length">
                                            <span>(OR)</span>
                                        </div>

                                    </div>
                                </div>

                                <!-- 3rd promotions -->
                                <div *ngIf="data.promotionTypesId==3"
                                    style="width:85%;margin-left: 50px;margin-top: -20px;">

                                    <div>
                                        <div class="buyGrp 1">

                                            <!-- headingds for 3rd promotions  tableborderss -->

                                            <div class="row label-div ">

                                                <div class="row">
                                                    <div class="col">
                                                        <span class="buy-grp" style="margin-left:17px"> Paid Items
                                                        </span>
                                                        <span class="total-itemss">
                                                            <span style="color:#000;"
                                                                [ngClass]="{ 'txt-error-span': ((!data.promoDetails.isItemValid || !data.promoDetails.isDiscountItemValid))   && data.showWarningMsg }">
                                                            </span>
                                                            <!-- <span style="color:#000;"> Discount percentage:
                                                                {{data.promoDetails.DiscountPercentage}}</span> -->
                                                        </span>
                                                        <span class="txt-error"
                                                            *ngIf="!(data.promoDetails.isItemValid) && data.showWarningMsg">
                                                            Please select full required quantity
                                                        </span>

                                                    </div>
                                                    <div class="col-2">
                                                        <mat-slide-toggle (click)="toggledatathirdpro()"  styel="margin-left:26px"> Items With Order Qty
                                                        </mat-slide-toggle> 
                                                    </div>
                                                    <div class="col-3">
                                                        <div class="searchBox11 d-flex">
                                                            <mat-icon
                                                                class="searchiconsFREEITEMSthree">search</mat-icon>
                                                            <input class="searchInput14" type="text" name=""
                                                                placeholder="Search..." [(ngModel)]="ThirdPromotion">
                                                            <button class="searchBTNthreepro">Search</button>

                                                        </div>
                                                    </div>
                                                    <div class="col-1">
                                                        <span id="m_oq"> MOQ<br>
                                                            {{data.promoDetails.moq}}</span>
                                                    </div>

                                                    <div class="col-1">
                                                        <span id="se_lected">Selected <br>
                                                            {{data.promoDetails.totalQuantity}}</span>
                                                    </div>

                                                    <div class="col-1">
                                                        <span id="se_lected">Remaining <br>


                                                        </span>
                                                    </div>
                                                </div>


                                                <!-- <div class="col-md-6">

                                                    <button class="searchButton" href="#">

                                                        <i class="material-icons">

                                                            search

                                                        </i>

                                                    </button>

                                                    <div class="searchBox d-flex" style=" cursor: pointer">

                                                        <input class="searchInput" style="font-family: 'Gilroy'"

                                                            type="text" name="" placeholder="Type & search for anything"

                                                            (keyup)="onSearchChange($event)">

                                                        <button class="search-btn"

                                                            style="font-family: 'Gilroy'">Search</button>

 

                                                    </div>

                                                </div> -->



                                            </div>

                                            <!-- tabels for 3rd promotions -->

                                            <div class="tabel_div">

                                                <table class="tableclass">

                                                    <thead class="table-headercolor">

                                                        <tr>

                                                            <th data-sortable="true" class="align-center">Product Code
                                                            </th>

                                                            <th data-sortable="true" class="align-center">Product Name
                                                            </th>

                                                            <th data-sortable="true" class="align-center">Identifiers
                                                            </th>

                                                            <th data-sortable="true" class="align-center">Registraion No
                                                            </th>
                                                            <th data-sortable="true" class="align-center">
                                                                MOQ</th>



                                                            <th data-sortable="true" class="align-center">Unit Price
                                                            </th>

                                                            <!-- <th data-sortable="true">SKU</th> -->

                                                            <!-- <th data-sortable="true">Price</th> -->

                                                            <!-- <th data-sortable="true">Qty. in Stock</th>

                                                            <th data-sortable="false">Tax Templete</th> -->



                                                            <th data-sortable="false" class="align-center"> Order Qty
                                                            </th>

                                                            <th data-sortable="false" class="align-center">Final Price
                                                            </th>

                                                            <th data-sortable="false" class="align-center">Order Amount
                                                            </th>

                                                        </tr>

                                                    </thead>

                                                    <tbody class="tbodayheight">

                                                        <tr class="table-row"
                                                            *ngFor="let Item of data.promoDetails.stockitems |filter:ThirdPromotion">
                                                            <ng-container  *ngIf="togglethiredpromotion ? Item.isProductSelected : true"> 
                                                            <td style="width: 24px;"><input type="checkbox"
                                                                    [checked]="Item.isProductSelected"
                                                                    (change)="checkboxChange($event,Item, data)"></td>

                                                            <td style="text-align: left;">{{Item.productSKUName}}</td>

                                                            <td style="text-align: left;">{{Item.stockitemname}} </td>

                                                            <!-- <td style="text-align: left;">{{Item.materialCustomName}}</td>  -->

                                                            <td style="text-align: left;">
                                                                {{Item.materialcustomidentifier}}</td>

                                                            <td style="text-align: left;">{{Item.registrationNumber}}
                                                            </td>
                                                            <td class="txt-right">{{data.promoDetails.moq}}</td>

                                                            <td class="txt-right">{{Item.price}}</td>

                                                            <!-- <td><input type="number" placeholder="Enter" class="quatity-inp"

                                                                    [(ngModel)]="Item.stock"></td> -->

                                                            <!-- <td>

                                                                <select class="tax-select" placeholder="select"

                                                                    [(ngModel)]="Item.Taxid">

                                                                    <option value="" selected hidden>Select tax</option>

                                                                    <option *ngFor="let option of taxdropdowndata"

                                                                        [value]="option.taxTemplateId">

                                                                        {{option.taxTemplateName}}

                                                                    </option>

                                                                </select>

                                                                <img src="assets/img/doubleTickes-default.svg"

                                                                    class="double-tick"

                                                                    (click)="doubleClick(data.promoDetails.stockitems, Item.Taxid)"

                                                                    alt="double-blue-tick">

                                                            </td> -->

                                                            <td><input type="number" placeholder="Enter Qty"
                                                                    class="quatity-inp" [(ngModel)]="Item.Quantity"
                                                                    (keyup)="quantityChange(data, Item)"></td>

                                                            <td class="txt-right"> {{(Item.finalPrice) | number :
                                                                '1.2-2'}}

                                                            </td>

                                                            <td class="txt-right">{{Item.DiscountAmount ?? 0 |

                                                                currency:'':''}}</td>
                                                      </ng-container>
                                                        </tr>

                                                    </tbody>

                                                    <!-- <tr class="bottom-table">

                                                        <td colspan="6" class="btm-total"><b>Total </b></td>

                                                        <td class="btm-total txt-right"> {{data.promoDetails.totalQuantity ?? 0 }}

                                                        </td>

                                                        <td class="btm-total">

                                                        </td>

                                                        <td class="txt-right">{{data.promoDetails.DiscountAmount ?? 0 | number : '1.2-2'}}

                                                    </tr> -->

                                                </table>

                                                <div class="bottom-table tt" id="totalnonprobackcolor"></div>

                                            </div>

                                        </div>

                                    </div>



                                </div>

                                <!-- 4th promotions -->
                                <div *ngIf="data.promotionTypesId==4">
                                    <div>
                                        <div class="buyGrp 1" style="margin-top: -10px;">
                                            <!-- headingds for 4th promotions -->
                                            <div class="row">
                                                <div class="col">
                                                    <span class="buy-grp" style="margin-left:40px"> Paid Items </span>
                                                    <span class="total-itemss" style="margin-left: 2px;">
                                                        <span style="color:#000;"
                                                            [ngClass]="{ 'txt-error-span': ((!data.promoDetails.isItemValid || !data.promoDetails.isDiscountItemValid))   && data.showWarningMsg }"></span>
                                                    </span>
                                                    <span class="txt-error"
                                                        *ngIf="!(data.promoDetails.isItemValid) && data.showWarningMsg">
                                                        Please select full required quantity
                                                    </span>

                                                </div>
                                                <div class="col-2" style="margin-top:10px">
                                                    <mat-slide-toggle  styel="margin-left:26px;" (click)="toggledataforthpro()"> Items With Order Qty
                                                    </mat-slide-toggle> 
                                                </div>
                                                <div class="col-3">
                                                    <div class="searchBox11 d-flex">
                                                        <mat-icon class="searchiconsForthPromotions">search</mat-icon>
                                                        <input class="searchInput16" type="text" name=""
                                                            placeholder="Search Here Anything"
                                                            [(ngModel)]="ForthPromotionsearch">
                                                        <button class="searchBTNforthpro">Search</button>

                                                    </div>

                                                </div>
                                                <div class="col-1">
                                                    <span id="m_oq"> MOQ<br>
                                                        {{data.promoDetails.moq}}</span>
                                                </div>

                                                <div class="col-1">
                                                    <span id="ForthPromotionse_lected">Selected <br>
                                                        {{data.promoDetails.totalQuantity}}</span>
                                                </div>
                                                <div class="col-1">
                                                    <span id="se_lected">Remaining

                                                    </span>
                                                </div>






                                                <!-- <div class="col-md-6">
                                                    <button class="searchButton" href="#">
                                                        <i class="material-icons">
                                                            search
                                                        </i>
                                                    </button>
                                                    <div class="searchBox d-flex" style=" cursor: pointer">
                                                        <input class="searchInput" style="font-family: 'Gilroy'"
                                                            type="text" name="" placeholder="Type & search for anything"
                                                            (keyup)="onSearchChange($event)">
                                                        <button class="search-btn"
                                                            style="font-family: 'Gilroy'">Search</button>

                                                    </div>
                                                </div> -->

                                                <!-- </div> -->
                                                <!-- tabels for 4th promotions -->
                                                <div class="tabelDIVFORTHPromotion">
                                                    <table class="tableForthpromotion">
                                                        <thead class="TableheaderbgColor">
                                                            <tr>

                                                                <th data-sortable="true" class="align-center">Product
                                                                    Code
                                                                </th>
                                                                <th data-sortable="true" class="align-center">Product
                                                                    Name
                                                                </th>
                                                                <th data-sortable="true" class="align-center">
                                                                    Identifiers
                                                                </th>
                                                                <th data-sortable="true" class="align-center">
                                                                    Registration
                                                                    No</th>
                                                                <th data-sortable="true" class="align-center">
                                                                    MOQ</th>
                                                                <th data-sortable="true" class="align-center">Unit Price
                                                                </th>
                                                                <!-- <th data-sortable="true">Qty. in Stock</th>
                                                            <th data-sortable="false">Tax Templete</th> -->
                                                            <th data-sortable="false" class="align-center">Order Qty 
                                                            </th>
                                                            <th data-sortable="false" class="align-center">Final Price
                                                            </th>
                                                            <th data-sortable="false" class="align-center">Order Amount
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="tbodayheightForthPro">
                                                        <tr class="table-row"
                                                            *ngFor="let Item of data.promoDetails.stockitems | filter:ForthPromotionsearch">
                                                            <ng-container  *ngIf="togglefrthpromotion ? Item.isProductSelected : true"> 
                                                            <td style="width: 16px;"><input type="checkbox"
                                                                    [checked]="Item.isProductSelected"
                                                                    (change)="checkboxChange($event,Item, data)"></td>
                                                            <td style="text-align: left;">{{Item.productSKUName}}</td>
                                                            <td style="text-align: left;">{{Item.stockitemname}}
                                                            </td>
                                                            <!-- <td style="text-align: left;">{{Item.materialCustomName}}</td> -->
                                                            <td style="text-align: left;">
                                                                {{Item.materialcustomidentifier}}
                                                            </td>
                                                            <td style="text-align: left;">{{Item.registrationNumber}}
                                                            </td>
                                                            <td class="txt-right">{{data.promoDetails.moq}}</td>

                                                                <td class="txt-right">{{Item.price}}</td>
                                                                <!-- <td><input type="number" placeholder="Enter" class="quatity-inp"
                                                                [(ngModel)]="Item.stock"></td> -->
                                                                <!-- <td>
                                                            <select class="tax-select" placeholder="select"
                                                                [(ngModel)]="Item.Taxid">
                                                                <option value="" selected hidden>Select tax</option>
                                                                <option *ngFor="let option of taxdropdowndata"
                                                                    [value]="option.taxTemplateId">
                                                                    {{option.taxTemplateName}}
                                                                </option>
                                                            </select>

                                                            <img src="assets/img/doubleTickes-default.svg"
                                                                class="double-tick"
                                                                (click)="doubleClick(data.promoDetails.stockitems, Item.Taxid)"
                                                                alt="double-blue-tick">

                                                        </td> -->
                                                                <td><input type="number" placeholder="Enter Qty"
                                                                        class="quatity-inp" [(ngModel)]="Item.Quantity"
                                                                        (keyup)="quantityChange(data, Item)"></td>

                                                            <td class="txt-right">{{Item.DiscountAmount ?? 0 | number :
                                                                '1.2-2'}}</td>
                                                            <td class="txt-right">{{(Item.finalPrice) | number :
                                                                '1.2-2'}}
                                                            </td>
                                                            </ng-container>
                                                        </tr>
                                                    </tbody>
                                                </table>

                                                    <div class="bottomtableFORTHPRo"
                                                        id="totalForthPROmotionbottomtable">
                                                        <tr>
                                                            <!-- <td colspan="6" class="btm-total"><b>Total </b></td>
    
                                                            <td class="btm-total txt-right">
                                                                {{data.promoDetails.totalQuantity ??
                                                                0 }}
                                                            </td>
                                                            <td class="btm-total"></td>
    
                                                            <td class="txt-right">{{data.promoDetails.DiscountAmount ?? 0 |
                                                                number : '1.2-2'}}
                                                            </td> -->

                                                        </tr>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- </div> -->

                    <button type="button" class="saveas-draft1" [disabled]="!isOrderPromotionValid"
                        (click)="addPromoItems()">Confirm
                    </button>



                    <!-- </div> -->
                    <!-- </div> -->